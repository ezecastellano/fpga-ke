KCPSM3 Assembler log file for program 'program1.psm'.
Generated by KCPSM3 version v2.01
Ken Chapman - Xilinx Ltd - 17th November 2011

Assembly datestamp: 04 Sep 2012
Assembly timestamp: 11:30:50

Last occupied address: 067 hex


 Addr Code                    Instruction

 000                          ; constants
 000                          CONSTANT read_strobe, 08
 000                          CONSTANT write_strobe, 04
 000                          CONSTANT red, E0
 000                          CONSTANT yellow, D8
 000                          CONSTANT green, 1C
 000                          CONSTANT blue, 03
 000                          CONSTANT white, FF
 000                          CONSTANT black, 00
 000                          CONSTANT rojoazul, C3
 000                          ; registers
 000                          NAMEREG s0, data_lo
 000                          NAMEREG s1, data_hi
 000                          NAMEREG s2, counter_lo
 000                          NAMEREG s3, counter_hi
 000                          NAMEREG s4, color2
 000                          NAMEREG s5, write
 000                          NAMEREG s6, data_in
 000                          NAMEREG s7, zero
 000                          NAMEREG s8, read
 000                          NAMEREG s9, color1
 000                          ;
 000                          NAMEREG sA, rd_addr_lo
 000                          NAMEREG sB, rd_addr_mi
 000                          NAMEREG sC, rd_addr_hi
 000                          NAMEREG sD, wr_addr_lo
 000                          NAMEREG sE, wr_addr_mi
 000                          NAMEREG sF, wr_addr_hi
 000                          ADDRESS 000
 000                          ;jump halt
 000  00C00                   LOAD sC[rd_addr_hi], 00
 001  00B00                   LOAD sB[rd_addr_mi], 00
 002  00A00                   LOAD sA[rd_addr_lo], 00
 003  00F00                   LOAD sF[wr_addr_hi], 00
 004  00E00                   LOAD sE[wr_addr_mi], 00
 005  00D00                   LOAD sD[wr_addr_lo], 00
 006  00200                   LOAD s2[counter_lo], 00
 007  00300                   LOAD s3[counter_hi], 00
 008  00808                   LOAD s8[read], 08[read_strobe]
 009  00504                   LOAD s5[write], 04[write_strobe]
 00A  00700                   LOAD s7[zero], 00
 00B  009FF                   LOAD s9[color1], FF[white]
 00C  004C3                   LOAD s4[color2], C3[rojoazul]
 00D  01090                   LOAD s0[data_lo], s9[color1]
 00E  01190                   LOAD s1[data_hi], s9[color1]
 00F                          ;ENABLE INTERRUPT
 00F                    main: 
 00F  30016                   CALL 016[read_word]
 010                          ;COMPARE data_lo,color2
 010                          ;CALL Z,change_color
 010  3003E                   CALL 03E[change_color2]
 011  3002C                   CALL 02C[inc_counters]
 012                          ;COMPARE counter_hi,FF
 012                          ;CALL Z,swap_colors
 012  30035                   CALL 035[image_read1]
 013  2C908                   OUTPUT s9[color1], 08
 014  2C407                   OUTPUT s4[color2], 07
 015  3400F                   JUMP 00F[main]
 016                          ;
 016                          ;
 016               read_word: 
 016  2CA02                   OUTPUT sA[rd_addr_lo], 02
 017  2CB03                   OUTPUT sB[rd_addr_mi], 03
 018  2CC04                   OUTPUT sC[rd_addr_hi], 04
 019  2C805                   OUTPUT s8[read], 05
 01A         wait_op_done_rd: 
 01A  04606                   INPUT s6[data_in], 06
 01B  14601                   COMPARE s6[data_in], 01
 01C  3541A                   JUMP NZ, 01A[wait_op_done_rd]
 01D  2C706                   OUTPUT s7[zero], 06
 01E  04000                   INPUT s0[data_lo], 00
 01F  04101                   INPUT s1[data_hi], 01
 020  2A000                   RETURN 
 021                          ;
 021              write_word: 
 021  2C000                   OUTPUT s0[data_lo], 00
 022  2C101                   OUTPUT s1[data_hi], 01
 023  2CD02                   OUTPUT sD[wr_addr_lo], 02
 024  2CE03                   OUTPUT sE[wr_addr_mi], 03
 025  2CF04                   OUTPUT sF[wr_addr_hi], 04
 026  2C505                   OUTPUT s5[write], 05
 027         wait_op_done_wr: 
 027  04606                   INPUT s6[data_in], 06
 028  14601                   COMPARE s6[data_in], 01
 029  35427                   JUMP NZ, 027[wait_op_done_wr]
 02A  2C706                   OUTPUT s7[zero], 06
 02B  2A000                   RETURN 
 02C                          ;
 02C            inc_counters: 
 02C  18201                   ADD s2[counter_lo], 01
 02D  1A300                   ADDCY s3[counter_hi], 00
 02E  18A01                   ADD sA[rd_addr_lo], 01
 02F  1AB00                   ADDCY sB[rd_addr_mi], 00
 030  1AC00                   ADDCY sC[rd_addr_hi], 00
 031  18D01                   ADD sD[wr_addr_lo], 01
 032  1AE00                   ADDCY sE[wr_addr_mi], 00
 033  1AF00                   ADDCY sF[wr_addr_hi], 00
 034  2A000                   RETURN 
 035                          ;
 035             image_read1: 
 035  14A80                   COMPARE sA[rd_addr_lo], 80
 036  31038                   CALL Z, 038[image_read2]
 037  2A000                   RETURN 
 038             image_read2: 
 038  14BA9                   COMPARE sB[rd_addr_mi], A9
 039  3103B                   CALL Z, 03B[image_read3]
 03A  2A000                   RETURN 
 03B             image_read3: 
 03B  14C03                   COMPARE sC[rd_addr_hi], 03
 03C  3104E                   CALL Z, 04E[swap_colors2]
 03D  2A000                   RETURN 
 03E           change_color2: 
 03E                          ; XOR data_lo, FF
 03E                          ; XOR data_hi, FF
 03E  30021                   CALL 021[write_word]
 03F  2A000                   RETURN 
 040            change_color: 
 040  01090                   LOAD s0[data_lo], s9[color1]
 041  01190                   LOAD s1[data_hi], s9[color1]
 042  30021                   CALL 021[write_word]
 043  2A000                   RETURN 
 044                          ;
 044                   delay: 
 044                          ;DISABLE INTERRUPT
 044  00800                   LOAD s8[read], 00
 045  00500                   LOAD s5[write], 00
 046                   loop1: 
 046  18701                   ADD s7[zero], 01
 047  1A800                   ADDCY s8[read], 00
 048  1A500                   ADDCY s5[write], 00
 049  35C46                   JUMP NC, 046[loop1]
 04A  00808                   LOAD s8[read], 08[read_strobe]
 04B  00504                   LOAD s5[write], 04[write_strobe]
 04C  00700                   LOAD s7[zero], 00
 04D                          ; ENABLE INTERRUPT
 04D  2A000                   RETURN 
 04E                          ;
 04E            swap_colors2: 
 04E  30044                   CALL 044[delay]
 04F  00C00                   LOAD sC[rd_addr_hi], 00
 050  00B00                   LOAD sB[rd_addr_mi], 00
 051  00A00                   LOAD sA[rd_addr_lo], 00
 052  00F00                   LOAD sF[wr_addr_hi], 00
 053  00E00                   LOAD sE[wr_addr_mi], 00
 054  00D00                   LOAD sD[wr_addr_lo], 00
 055  00200                   LOAD s2[counter_lo], 00
 056  00300                   LOAD s3[counter_hi], 00
 057  2A000                   RETURN 
 058             swap_colors: 
 058  30044                   CALL 044[delay]
 059  0F940                   XOR s9[color1], s4[color2]
 05A  0F490                   XOR s4[color2], s9[color1]
 05B  0F940                   XOR s9[color1], s4[color2]
 05C  01090                   LOAD s0[data_lo], s9[color1]
 05D  01190                   LOAD s1[data_hi], s9[color1]
 05E  00C00                   LOAD sC[rd_addr_hi], 00
 05F  00B00                   LOAD sB[rd_addr_mi], 00
 060  00A00                   LOAD sA[rd_addr_lo], 00
 061  00F00                   LOAD sF[wr_addr_hi], 00
 062  00E00                   LOAD sE[wr_addr_mi], 00
 063  00D00                   LOAD sD[wr_addr_lo], 00
 064  00200                   LOAD s2[counter_lo], 00
 065  00300                   LOAD s3[counter_hi], 00
 066  2A000                   RETURN 
 067                          ;
 067                    halt: 
 067  34067                   JUMP 067[halt]
 068                          ;
 068                          ;isr:
 068                          ; INPUT zero,07
 068                          ; OUTPUT zero,07
 068                          ; OUTPUT zero,08
 068                          ; LOAD zero,00
 068                          ; RETURNI enable
 068                          ;ADDRESS 3FF
 068                          ;JUMP isr



List of defined constants

timestamp_hours = 11'd
timestamp_minutes = 30'd
timestamp_seconds = 50'd
datestamp_year = 12'd
datestamp_month = 9'd
datestamp_day = 04'd
read_strobe = 08
write_strobe = 04
red = E0
yellow = D8
green = 1C
blue = 03
white = FF
black = 00
rojoazul = C3



List of text strings

KCPSM3_version$ = "v2.01"
datestamp$ = "04 Sep 2012"
timestamp$ = "11:30:50"



End of KCPSM3 log file.
